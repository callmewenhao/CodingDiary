### 原地哈希（正负号标记）

> 题目：[442. 数组中重复的数据](https://leetcode-cn.com/problems/find-all-duplicates-in-an-array/)

这道题要求找出数组 $nums$ 中的所有出现**两次的整数**并返回。

**常规做法：**使用哈希表存储数组中的整数，遍历数组并将每个整数存入哈希表，如果遍历到一个元素时发现该元素已经在哈希表中，则该元素是出现两次的整数。对于长度为 $n$ 的数组，使用哈希表的时间复杂度是 $O(n)$，符合题目要求，但是空间复杂度是 $O(n)$，不符合题目要求的常数空间。

为了将空间复杂度降低到常数，不能额外创建哈希表，只能原地修改数组。由于数组 $nums$ 的长度是 $n$，下标范围是 $[0,n−1]$，每个元素都在范围 $[1,n]$ 内，**因此可以将数组看成哈希表**，利用数组**下标的信息**表示每个整数是否出现两次。

对于下标 $index$，满足 $0 \le index < n, 1≤index+1\le n$，$nums[index]$ 可以用于表示整数 $index+1$ 是否出现两次。

遍历数组 $nums$。对于元素 $num$，其对应的下标为 $\textit{index} = |\textit{num}| - 1$，根据 $nums[index]$ 的正负性执行如下操作：

- 如果 $nums[index]>0$，则将 $nums[index]$ 的值更新为其相反数；

- 如果 $nums[index]<0$，则 $∣nums∣=index+1$ 是出现两次的整数，将其添加到结果中。

上述做法的原理如下：

1. 初始时数组 $nums$ 中的整数都是正数，表示尚未被访问；

2. 当一个整数被访问时，如果该整数对应的下标处的元素是正数，则该整数尚未被访问，因此将该整数对应的下标处的元素改成其相反数，相反数是负数，表示被访问了一次；

3. 当一个整数被访问时，如果该整数对应的下标处的元素是负数，则该整数已经被访问，因此该整数被第二次访问，即该整数是出现两次的整数。

需要注意的是，遍历数组 $nums$ 的过程中，遍历到的元素 $num$ 可能已经被改成负数，因此在计算下标 $index$ 时需要对 $num$ 取绝对值然后减 1。

